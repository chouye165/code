<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>温馨提示爱心阵</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", 微软雅黑, sans-serif;
            overflow: hidden;
            background-color: #f5f5f5;
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        /* 提示窗口样式 - 移动端优化 */
        .tip-window {
            position: absolute;
            width: 120px;
            height: 40px;
            padding: 6px;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 12px;
            z-index: 9999;
            transition: all 0.3s ease;
            overflow: hidden;
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.2;
        }

        /* 桌面端样式 */
        @media (min-width: 768px) {
            .tip-window {
                width: 200px;
                height: 50px;
                padding: 8px;
                font-size: 14px;
            }
        }

        /* 大屏幕样式 */
        @media (min-width: 1024px) {
            .tip-window {
                width: 250px;
                height: 60px;
                padding: 10px;
                font-size: 16px;
            }
        }

        /* 启动按钮容器：居中显示 */
        .start-btn-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10000;
            transition: all 0.3s ease;
        }

        /* 启动按钮样式 - 移动端优化 */
        #startBtn {
            padding: 12px 30px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
            -webkit-tap-highlight-color: transparent;
        }

        #startBtn:hover {
            background-color: #45a049;
        }

        #startBtn:active {
            transform: scale(0.95);
        }

        #startBtn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        /* 桌面端启动按钮 */
        @media (min-width: 768px) {
            #startBtn {
                padding: 15px 40px;
                font-size: 18px;
                border-radius: 8px;
            }
        }

        /* 清除按钮样式：固定在右上角 */
        #clearBtn {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 10000;
            padding: 8px 16px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            display: none; /* 默认隐藏 */
            transition: background-color 0.3s ease;
            -webkit-tap-highlight-color: transparent;
        }

        #clearBtn:hover {
            background-color: #d32f2f;
        }

        #clearBtn:active {
            transform: scale(0.95);
        }

        /* 桌面端清除按钮 */
        @media (min-width: 768px) {
            #clearBtn {
                top: 20px;
                right: 20px;
                padding: 10px 20px;
                font-size: 16px;
            }
        }

        /* 移动端特有优化 */
        @media (max-width: 767px) {
            body {
                -webkit-text-size-adjust: 100%;
                -ms-text-size-adjust: 100%;
            }
            
            .tip-window {
                max-width: 90vw;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <!-- 启动按钮容器（居中） -->
    <div class="start-btn-container" id="startBtnContainer">
        <button id="startBtn" onclick="startTips()">启动</button>
    </div>

    <!-- 清除按钮（默认隐藏，右上角） -->
    <button id="clearBtn" onclick="clearAllTips()">清除</button>

    <script>
        // 配置参数（固定窗口数量为100）
        const CONFIG = {
            window_count: 100, // 固定使用100个窗口
            window_width: 250,
            window_height: 60,
            display_time: 30000, // 毫秒
            start_delay: 50, // 毫秒（原0.05秒=50毫秒）
            heart_scale: 0.4,
        };

        // 温馨提示列表
        const TIPS = [
            "多喝水哦~", "保持微笑呀", "每天都要元气满满", "记得吃水果",
            "保持好心情", "好好爱自己", "我想你了", "梦想成真",
            "期待见面", "金榜题名", "顺顺利利", "早点休息",
            "烦恼消失", "别熬夜", "开心嘛", "多穿衣服"
        ];

        // 背景颜色列表
        const BG_COLORS = [
            "lightpink", "skyblue", "lightgreen", "lavender", "lightyellow",
            "plum", "coral", "bisque", "aquamarine", "mistyrose",
            "honeydew", "lavenderblush", "oldlace"
        ];

        // 全局变量
        let windowIndexCounter = 0;
        let windowCountForHeart = 0;
        let tipElements = []; // 存储所有提示窗口元素，用于批量清除
        let startBtn = null;
        let clearBtn = null;
        let startBtnContainer = null;
        let allTipsCreated = false; // 标记是否所有窗口都已创建完成

        // 初始化元素引用
        window.onload = function() {
            startBtn = document.getElementById('startBtn');
            clearBtn = document.getElementById('clearBtn');
            startBtnContainer = document.getElementById('startBtnContainer');
            
            // 防止移动端双击缩放
            document.addEventListener('touchstart', function(event) {
                if (event.touches.length > 1) {
                    event.preventDefault();
                }
            });
            
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(event) {
                const now = Date.now();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
        };

        /**
         * 获取响应式窗口尺寸
         */
        function getResponsiveWindowSizes() {
            const screenWidth = window.innerWidth;
            
            if (screenWidth < 768) {
                return { width: 120, height: 40 }; // 移动端
            } else if (screenWidth < 1024) {
                return { width: 200, height: 50 }; // 平板
            } else {
                return { width: 250, height: 60 }; // 桌面
            }
        }

        /**
         * 生成爱心坐标（优化移动端显示）
         * @param {number} index - 当前窗口索引
         * @param {number} total - 总窗口数
         * @returns {Object} x, y 坐标
         */
        function getHeartCoordinates(index, total) {
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            const windowSizes = getResponsiveWindowSizes();
            const windowWidth = windowSizes.width;
            const windowHeight = windowSizes.height;

            // 动态调整缩放比例，移动端使用更小的缩放
            let scale = CONFIG.heart_scale;
            if (screenWidth < 768) {
                scale = 0.25; // 移动端缩得更小
            } else if (screenWidth < 1024) {
                scale = 0.32; // 平板适中的缩放
            }

            // 爱心曲线参数方程
            const t = 2 * Math.PI * index / total;
            const x = 16 * Math.pow(Math.sin(t), 3);
            const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);

            // 缩放和居中处理
            const scaleFactor = Math.min(screenWidth, screenHeight) * scale / 16;
            const centerX = screenWidth / 2 - windowWidth / 2;
            const centerY = screenHeight / 2 - windowHeight / 2;

            // 计算最终坐标（反转y轴，因为屏幕坐标y轴向下）
            let finalX = centerX + x * scaleFactor;
            let finalY = centerY - y * scaleFactor;

            // 移动端减少随机偏移，避免重叠
            const jitterRange = screenWidth < 768 ? 3 : 5;
            const jitterX = Math.random() * jitterRange * 2 - jitterRange;
            const jitterY = Math.random() * jitterRange * 2 - jitterRange;
            finalX += jitterX;
            finalY += jitterY;

            // 确保坐标在屏幕范围内，保留适当边距
            const margin = screenWidth < 768 ? 5 : 10;
            finalX = Math.max(margin, Math.min(finalX, screenWidth - windowWidth - margin));
            finalY = Math.max(margin, Math.min(finalY, screenHeight - windowHeight - margin));

            return { x: finalX, y: finalY };
        }

        /**
         * 创建单个提示窗口
         */
        function showWarmTip() {
            try {
                // 获取坐标
                const coords = getHeartCoordinates(windowIndexCounter, windowCountForHeart);
                windowIndexCounter++;

                // 随机选择提示和背景色
                const tip = TIPS[Math.floor(Math.random() * TIPS.length)];
                const bg = BG_COLORS[Math.floor(Math.random() * BG_COLORS.length)];

                // 创建窗口元素
                const windowElement = document.createElement('div');
                windowElement.className = 'tip-window';
                windowElement.style.left = `${coords.x}px`;
                windowElement.style.top = `${coords.y}px`;
                windowElement.style.backgroundColor = bg;
                windowElement.textContent = tip;

                // 添加到页面和存储数组
                document.body.appendChild(windowElement);
                tipElements.push(windowElement);

                // 30秒后移除窗口（渐变消失效果）
                setTimeout(() => {
                    if (windowElement.parentNode) {
                        windowElement.style.opacity = 0;
                        setTimeout(() => {
                            if (windowElement.parentNode) {
                                document.body.removeChild(windowElement);
                            }
                            // 从数组中移除
                            tipElements = tipElements.filter(el => el !== windowElement);
                        }, 300);
                    }
                }, CONFIG.display_time);

                // 检查是否所有窗口都已创建完成
                if (windowIndexCounter >= CONFIG.window_count) {
                    allTipsCreated = true;
                    clearBtn.style.display = 'block'; // 显示清除按钮
                }

            } catch (e) {
                console.error('创建窗口时出错：', e);
            }
        }

        /**
         * 启动提示窗口（固定使用100个窗口）
         */
        function startTips() {
            // 初始化状态
            windowIndexCounter = 0;
            windowCountForHeart = CONFIG.window_count;
            tipElements = [];
            allTipsCreated = false;
            clearBtn.style.display = 'none'; // 隐藏清除按钮

            // 禁用启动按钮
            startBtn.disabled = true;
            // 隐藏启动按钮容器（视觉上更清爽）
            startBtnContainer.style.opacity = 0;

            // 计算总延迟时间（所有窗口创建完成的时间）
            const totalDelay = CONFIG.window_count * CONFIG.start_delay;

            // 依次创建100个窗口（延迟启动）
            let delay = 0;
            for (let i = 0; i < CONFIG.window_count; i++) {
                setTimeout(() => {
                    showWarmTip();
                }, delay);
                delay += CONFIG.start_delay;
            }
        }

        /**
         * 清除所有提示窗口并重置界面
         */
        function clearAllTips() {
            // 批量移除所有提示窗口
            tipElements.forEach(element => {
                if (element.parentNode) {
                    element.style.opacity = 0;
                    setTimeout(() => {
                        if (element.parentNode) {
                            document.body.removeChild(element);
                        }
                    }, 300);
                }
            });
            tipElements = []; // 清空数组

            // 重置状态
            allTipsCreated = false;
            clearBtn.style.display = 'none'; // 隐藏清除按钮
            startBtn.disabled = false; // 启用启动按钮
            startBtnContainer.style.opacity = 1; // 显示启动按钮容器（居中）
        }

        // 处理屏幕旋转
        window.addEventListener('resize', function() {
            // 如果有窗口显示，重新计算位置
            if (tipElements.length > 0 && allTipsCreated) {
                // 可选：重新调整现有窗口位置
                console.log('屏幕方向改变，窗口位置可能需要调整');
            }
        });
    </script>
</body>
</html>